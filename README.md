<h1 align="center">
  <span class="rocket">ğŸš€</span> Infraestrutura PadrÃ£o para Desenvolvimento
</h1>

<div align="center">

<p align="center">
  <img src="https://akumeninc.com/wp-content/uploads/DevSecOps-Animation.gif" alt="Infra DevTools e DevOps" width="600"/>

<strong>ğŸš€ Infra DevTools e Pipelines CI/CD ğŸ”§</strong><br>
âš™ï¸ Ferramentas para infraestrutura como cÃ³digo, automaÃ§Ã£o, testes, monitoramento.<br>
âœ… Ideal para fluxos modernos com seguranÃ§a ğŸ”, observabilidade ğŸ“Š e eficiÃªncia âš¡.

<em>
â€¢ Docker & Compose â€¢ CI/CD â€¢ Logs Estruturados â€¢ SonarQube â€¢ Monitoramento (Prometheus, Grafana, Alertmanager, Blackbox Exporter) â€¢ Multi-Bancos de Dados (MongoDB, PostgreSQL, MySQL, Redis, Vault) â€¢ RabbitMQ â€¢ Portainer â€¢ AutomaÃ§Ã£o (Makefile)
</em>

</div>

<br>

<div align="center">

> âš ï¸ **Este projeto estÃ¡ ğŸš€ _(Em Constante Desenvolvimento ğŸš§)_**
>
> Algumas funcionalidades podem estar incompletas ou sujeitas a alteraÃ§Ãµes. ContribuiÃ§Ãµes sÃ£o bem-vindas! ğŸ› ï¸

</div>

## ğŸ› ï¸ Tecnologias Utilizadas

<div align="center">

![Docker](https://img.shields.io/badge/Docker-%230db7ed.svg?style=for-the-badge&logo=docker&logoColor=white)
![Makefile](https://img.shields.io/badge/Makefile-%23F7DF1E.svg?style=for-the-badge&logo=gnu&logoColor=black)
![SonarQube](https://img.shields.io/badge/SonarQube-%2300B4AB.svg?style=for-the-badge&logo=sonarqube&logoColor=white)
![Portainer](https://img.shields.io/badge/Portainer-%230072CE.svg?style=for-the-badge&logo=portainer&logoColor=white)
![Mongo Express](https://img.shields.io/badge/Mongo%20Express-%2347A248.svg?style=for-the-badge&logo=mongodb&logoColor=white)
![pgAdmin](https://img.shields.io/badge/pgAdmin-%23336791.svg?style=for-the-badge&logo=postgresql&logoColor=white)
![phpMyAdmin](https://img.shields.io/badge/phpMyAdmin-%2347A248.svg?style=for-the-badge&logo=mysql&logoColor=white)
![RedisInsight](https://img.shields.io/badge/RedisInsight-%23DC382D.svg?style=for-the-badge&logo=redis&logoColor=white)
![Prometheus](https://img.shields.io/badge/Prometheus-%23E6522C.svg?style=for-the-badge&logo=prometheus&logoColor=white)
![Grafana](https://img.shields.io/badge/Grafana-%23F46800.svg?style=for-the-badge&logo=grafana&logoColor=white)
![Alertmanager](https://img.shields.io/badge/Alertmanager-%23E6522C.svg?style=for-the-badge&logo=prometheus&logoColor=white)
![Blackbox Exporter](https://img.shields.io/badge/Blackbox%20Exporter-%2300BFFF.svg?style=for-the-badge&logo=linux&logoColor=white)
![cAdvisor](https://img.shields.io/badge/cAdvisor-%234285F4.svg?style=for-the-badge&logo=google-cloud&logoColor=white)
![Node Exporter](https://img.shields.io/badge/Node%20Exporter-%2300BFFF.svg?style=for-the-badge&logo=linux&logoColor=white)
![MongoDB Exporter](https://img.shields.io/badge/MongoDB%20Exporter-%2347A248.svg?style=for-the-badge&logo=mongodb&logoColor=white)
![Postgres Exporter](https://img.shields.io/badge/Postgres%20Exporter-%23336791.svg?style=for-the-badge&logo=postgresql&logoColor=white)
![MySQL Exporter](https://img.shields.io/badge/MySQL%20Exporter-%2347A248.svg?style=for-the-badge&logo=mysql&logoColor=white)
![Redis Exporter](https://img.shields.io/badge/Redis%20Exporter-%23DC382D.svg?style=for-the-badge&logo=redis&logoColor=white)
![RabbitMQ](https://img.shields.io/badge/RabbitMQ-%23FF6600.svg?style=for-the-badge&logo=rabbitmq&logoColor=white)
![RabbitMQ Exporter](https://img.shields.io/badge/RabbitMQ%20Exporter-%23FF6600.svg?style=for-the-badge&logo=rabbitmq&logoColor=white)
![Vault](https://img.shields.io/badge/Vault-%23000000.svg?style=for-the-badge&logo=vault&logoColor=white)
![Mailhog](https://img.shields.io/badge/Mailhog-%23EA4335.svg?style=for-the-badge&logo=gmail&logoColor=white)
![Keycloak](https://img.shields.io/badge/Keycloak-%23336791.svg?style=for-the-badge&logo=keycloak&logoColor=white)
![Eureka](https://img.shields.io/badge/Eureka-%2300BFFF.svg?style=for-the-badge&logo=spring&logoColor=white)

</div>

## ğŸŒŸ **Por que este projeto Ã© importante?**

Desenvolver aplicaÃ§Ãµes modernas exige uma infraestrutura que seja **rÃ¡pida, confiÃ¡vel e fÃ¡cil de gerenciar**. Este projeto foi criado para resolver os desafios enfrentados por desenvolvedores ao configurar ambientes de desenvolvimento, como:

- **ReduÃ§Ã£o de tempo de configuraÃ§Ã£o:** Com o uso de Docker Compose, vocÃª pode iniciar todos os serviÃ§os essenciais com um Ãºnico comando.
- **PadronizaÃ§Ã£o:** Uma infraestrutura consistente para todos os membros da equipe, eliminando problemas de "funciona na minha mÃ¡quina".
- **Monitoramento e qualidade:** Ferramentas como Prometheus, Grafana e SonarQube ajudam a monitorar mÃ©tricas e manter a qualidade do cÃ³digo.
- **Escalabilidade:** Pronto para crescer junto com o seu projeto, seja ele um MVP ou uma aplicaÃ§Ã£o em produÃ§Ã£o.

Se vocÃª Ã© um desenvolvedor que busca **otimizar seu fluxo de trabalho**, este projeto Ã© para vocÃª! ğŸš€

## âœ¨ **Destaques do Projeto**

- **ConfiguraÃ§Ã£o simplificada:** Todos os serviÃ§os essenciais (bancos de dados, monitoramento, anÃ¡lise de cÃ³digo) estÃ£o prontos para uso com Docker Compose.
- **Ferramentas de monitoramento:** Prometheus, Grafana e cAdvisor para mÃ©tricas e dashboards.
- **Interfaces grÃ¡ficas:** Portainer, pgAdmin, phpMyAdmin e RedisInsight para facilitar a administraÃ§Ã£o de serviÃ§os.
- **AutomaÃ§Ã£o:** Um `Makefile` com comandos prÃ¡ticos para gerenciar containers e tarefas comuns.
- **SeguranÃ§a:** VerificaÃ§Ã£o de dependÃªncias com OWASP Dependency-Check.
- **Flexibilidade:** Suporte para mÃºltiplos bancos de dados (PostgreSQL, MySQL, MongoDB) e cache distribuÃ­do com Redis.

## ğŸ’¡ **Como este projeto pode ajudar vocÃª?**

1. **Economize tempo:** NÃ£o perca horas configurando serviÃ§os manualmente. Com este projeto, vocÃª pode iniciar tudo com um Ãºnico comando.
2. **Aprenda boas prÃ¡ticas:** Explore como configurar e integrar ferramentas amplamente utilizadas no mercado.
3. **Melhore a colaboraÃ§Ã£o:** Garanta que todos os membros da equipe tenham o mesmo ambiente de desenvolvimento.
4. **Monitore e otimize:** Use ferramentas de monitoramento para identificar gargalos e melhorar o desempenho da sua aplicaÃ§Ã£o.

## ğŸš€ **Entregas Implementadas na Infraestrutura**

Esta seÃ§Ã£o destaca os principais componentes jÃ¡ implementados e funcionando na infraestrutura:

#### ğŸ³ ContainerizaÃ§Ã£o e OrquestraÃ§Ã£o

- âœ… ContainerizaÃ§Ã£o de ServiÃ§os: Todos os serviÃ§os essenciais foram empacotados em containers Docker, garantindo isolamento, portabilidade e fÃ¡cil replicaÃ§Ã£o do ambiente.

- âœ… OrquestraÃ§Ã£o com Docker Compose: Gerenciamento centralizado de mÃºltiplos containers, facilitando o start, stop e rebuild de toda a stack de forma prÃ¡tica.

#### âš™ï¸ ConfiguraÃ§Ã£o e AutomaÃ§Ã£o

- âœ… ConfiguraÃ§Ã£o via Arquivo .env: Gerenciamento centralizado e seguro das variÃ¡veis de ambiente.

- âœ… AutomaÃ§Ã£o de Tarefas Comuns: UtilizaÃ§Ã£o de Makefile, Taskfile e scripts npm para executar tarefas como iniciar, parar, visualizar logs e executar testes.

- âœ… Compatibilidade Multiplataforma: InstruÃ§Ãµes e scripts alternativos para Windows (Taskfile, npm scripts) garantindo funcionamento multiplataforma.

#### ğŸ§ª Qualidade de CÃ³digo e SeguranÃ§a

- âœ… AnÃ¡lise de Qualidade de CÃ³digo: IntegraÃ§Ã£o com SonarQube para anÃ¡lise estÃ¡tica e verificaÃ§Ã£o de seguranÃ§a do cÃ³digo.

- âœ… ConfiguraÃ§Ã£o do SonarQube Scanner: Suporte ao scanner para rodar verificaÃ§Ãµes diretamente no pipeline.

- âœ… VerificaÃ§Ã£o de DependÃªncias: Script com OWASP Dependency-Check para identificar vulnerabilidades em dependÃªncias de projeto.

#### ğŸ§¬ Monitoramento e Observabilidade

- âœ… Monitoramento com Prometheus: Coleta de mÃ©tricas de diversos serviÃ§os da infraestrutura.

- âœ… VisualizaÃ§Ã£o com Grafana: Dashboards personalizados para anÃ¡lise de mÃ©tricas.

- âœ… Alertas e DiagnÃ³stico: IntegraÃ§Ã£o com Alertmanager, Blackbox Exporter, cAdvisor e Node Exporter.

- âœ… Exportadores de MÃ©tricas: Exporters configurados para MongoDB, PostgreSQL, MySQL, Redis, RabbitMQ e sistema (Node Exporter).

- âœ… Monitoramento de Containers: Uso do cAdvisor para mÃ©tricas de CPU, memÃ³ria, rede e disco por container.

#### ğŸ—ƒï¸ Banco de Dados e Cache

- âœ… MongoDB: Com interface de administraÃ§Ã£o via Mongo Express.

- âœ… PostgreSQL: Gerenciado com pgAdmin.

- âœ… MySQL: Com administraÃ§Ã£o via phpMyAdmin.

- âœ… Redis: Sistema de cache de alta performance com visualizaÃ§Ã£o via RedisInsight.

- âœ… Ambiente Multibanco: Suporte completo e funcional para mÃºltiplos bancos de dados.

#### ğŸ“¡ Mensageria e APIs

- âœ… RabbitMQ: ServiÃ§o de mensageria com painel administrativo e exporters de mÃ©tricas.

- âœ… APIs e Webhooks: Estrutura pronta para endpoints REST e escuta de webhooks.

#### ğŸ” SeguranÃ§a e Gerenciamento

- âœ… Gerenciamento de Segredos: Vault configurado para armazenamento seguro de segredos e tokens.

- âœ… AutenticaÃ§Ã£o e AutorizaÃ§Ã£o: Keycloak integrado como Identity Provider para controle de acesso.

- âœ… Service Discovery: Eureka Server disponÃ­vel para registro e descoberta de microsserviÃ§os.

#### ğŸ“§ Outros ServiÃ§os

- âœ… Mailhog: ServiÃ§o local para captura e visualizaÃ§Ã£o de e-mails em ambiente de desenvolvimento.

#### ğŸ“ DocumentaÃ§Ã£o

- âœ… README.md Abrangente: DocumentaÃ§Ã£o detalhada explicando os serviÃ§os incluÃ­dos, uso e estrutura da infraestrutura.

## ğŸ“‚ **Estrutura do Projeto**

```plaintext
â”œâ”€â”€ assets/                  # Imagens, GIFs e recursos visuais
â”œâ”€â”€ reports/                 # RelatÃ³rios de testes e seguranÃ§a
â”œâ”€â”€ scripts/                 # Scripts auxiliares (ex: run-dependency-check.sh, setup.sh)
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ tests/               # Testes automatizados
â”‚   â””â”€â”€ utils/               # UtilitÃ¡rios (ex: convert_junit_to_sonar.py)
â”œâ”€â”€ .env.example             # Exemplo de variÃ¡veis de ambiente
â”œâ”€â”€ [.env.development](http://_vscodecontentref_/2)         # VariÃ¡veis para ambiente de desenvolvimento
â”œâ”€â”€ .prettierrc              # ConfiguraÃ§Ã£o do Prettier
â”œâ”€â”€ .prettierignore          # Arquivos ignorados pelo Prettier
â”œâ”€â”€ .eslintrc.json           # ConfiguraÃ§Ã£o do ESLint
â”œâ”€â”€ [eslint.config.ts](http://_vscodecontentref_/3)         # ConfiguraÃ§Ã£o alternativa do ESLint
â”œâ”€â”€ [jest.config.ts](http://_vscodecontentref_/4)           # ConfiguraÃ§Ã£o do Jest
â”œâ”€â”€ [pytest.ini](http://_vscodecontentref_/5)               # ConfiguraÃ§Ã£o do Pytest
â”œâ”€â”€ [sonar-project.properties](http://_vscodecontentref_/6) # ConfiguraÃ§Ã£o do SonarQube
â”œâ”€â”€ Makefile                 # Comandos automatizados
â”œâ”€â”€ Taskfile.yml             # Alternativa multiplataforma ao Makefile
â”œâ”€â”€ [docker-compose.yml](http://_vscodecontentref_/7)       # OrquestraÃ§Ã£o dos containers
â”œâ”€â”€ [prometheus.yml](http://_vscodecontentref_/8)           # ConfiguraÃ§Ã£o do Prometheus
â”œâ”€â”€ [README.md](http://_vscodecontentref_/9)                # DocumentaÃ§Ã£o principal
â”œâ”€â”€ [package.json](http://_vscodecontentref_/10)             # DependÃªncias e scripts npm
>>>>>>> Stashed changes
```

## ğŸ› ï¸ InstalaÃ§Ã£o e Uso do Infra DevTools para Desenvolvedores ğŸ‘¨â€ğŸ’»

Este projeto facilita a configuraÃ§Ã£o de um ambiente de desenvolvimento robusto com ferramentas essenciais como SonarQube, MongoDB, PostgreSQL, Prometheus, Grafana, Portainer e muito mais! ğŸš€

> âš ï¸ **AtenÃ§Ã£o: SeguranÃ§a em Primeiro Lugar!**
>
> O arquivo .env **NÃƒO** deve ser versionado ou incluÃ­do no repositÃ³rio, por boas prÃ¡ticas de seguranÃ§a.
>
> Este arquivo geralmente contÃ©m informaÃ§Ãµes sensÃ­veis, como:
>
> - ğŸ” Credenciais de banco de dados
> - ğŸ”‘ Chaves de API
> - ğŸ•µï¸â€â™‚ï¸ Segredos da aplicaÃ§Ã£o
>
> âœ… Em vez disso:
>
> - Adicione .env ao .gitignore
> - Crie um arquivo .env.example com as variÃ¡veis necessÃ¡rias (sem dados sensÃ­veis)
> - Documente no README.md como configurar o .env localmente
>
> ğŸ”’ Isso protege seu projeto contra vazamentos acidentais de informaÃ§Ãµes crÃ­ticas.

**VocÃª tem duas formas principais de integrar o Infra DevTools ao seu fluxo de trabalho:**

## ğŸ“¦ 1. UtilizaÃ§Ã£o Direta no Seu Ambiente Local:

### â¬‡ï¸ Clone o repositÃ³rio

```bash
git clone https://github.com/KleilsonSantos/infra-devtools.git
```

### ğŸ“‚ Acesse a pasta

```bash
cd infra-devtools
```

### âš™ï¸ Configure seu ambiente (.env)

```bash
cp .env.development .env
nano .env
```

## ğŸ”— 2. IntegraÃ§Ã£o como SubmÃ³dulo Git no Seu Projeto:

**ğŸ“¦ git submodule add [https://github.com/KleilsonSantos/infra-devtools.git](https://github.com/KleilsonSantos/infra-devtools.git) infra-devtools**

### â• Adicione como submÃ³dulo

```bash
git submodule add https://github.com/KleilsonSantos/infra-devtools.git
```

### âš™ï¸ Inicialize e atualize

```bash
git submodule update --init --recursive
```

### ğŸ“‚ Acesse a pasta do submÃ³dulo

```bash
cd infra-devtools
```

### âš™ï¸ Configure seu ambiente (.env)

```bash
cp .env.development .env
nano .env
```

## ğŸ§± **Como subir a infraestrutura**

Execute o comando abaixo para iniciar todos os serviÃ§os:

```
make up
```

Para derrubar os serviÃ§os:

```bash
make down
```

Para verificar os logs:

```bash
make logs
```

## âœ… **ServiÃ§os incluÃ­dos**

| ServiÃ§o                  | Porta   | Acesso                                           |
| ------------------------ | ------- | ------------------------------------------------ |
| ğŸ›  **SonarQube**         | `9002`  | [http://localhost:9002](http://localhost:9002)   |
| ğŸ³ **Portainer**         | `9001`  | [http://localhost:9001](http://localhost:9001)   |
| ğŸŒ **Mongo Express**     | `8081`  | [http://localhost:8081](http://localhost:8081)   |
| ğŸ–¥ï¸ **pgAdmin**           | `8088`  | [http://localhost:8088](http://localhost:8088)   |
| ğŸ§° **phpMyAdmin**        | `8082`  | [http://localhost:8082](http://localhost:8082)   |
| ğŸ§  **RedisInsight**      | `8083`  | [http://localhost:8083](http://localhost:8083)   |
| ğŸ“ˆ **Prometheus**        | `9090`  | [http://localhost:9090](http://localhost:9090)   |
| ğŸ“Š **Grafana**           | `3001`  | [http://localhost:3001](http://localhost:3001)   |
| ğŸ¾ **cAdvisor**          | `8080`  | [http://localhost:8080](http://localhost:8080)   |
| ğŸš¨ **Alertmanager**      | `9093`  | [http://localhost:9093](http://localhost:9093)   |
| ğŸ•µï¸ **Blackbox Exporter** | `9115`  | [http://localhost:9115](http://localhost:9115)   |
| ğŸ° **RabbitMQ**          | `15672` | [http://localhost:15672](http://localhost:15672) |
| ğŸ” **Vault**             | `8200`  | [http://localhost:8200](http://localhost:8200)   |
| ğŸ“§ **Mailhog**           | `8025`  | [http://localhost:8025](http://localhost:8025)   |
| ğŸ›°ï¸ **Eureka Server**     | `8761`  | [http://localhost:8761](http://localhost:8761)   |
| ğŸ‘¤ **Users API**         | `8089`  | [http://localhost:8089](http://localhost:8089)   |
| ğŸ”” **Webhook Listener**  | `8090`  | [http://localhost:8090](http://localhost:8090)   |
| ğŸ˜ **PostgreSQL**        | `5432`  | _Acesso interno (via pgAdmin ou app)_            |
| ğŸƒ **MongoDB**           | `27017` | _Acesso interno (via Mongo Express ou app)_      |
| ğŸ¬ **MySQL**             | `3306`  | _Acesso interno (via phpMyAdmin ou app)_         |
| ğŸ“¦ **Redis**             | `6379`  | _Acesso interno (via RedisInsight ou app)_       |
| ğŸ–¥ï¸ **Node Exporter**     | `9100`  | _Acesso interno (para mÃ©tricas do sistema)_      |
| ğŸ¬ **MySQL Exporter**    | `9104`  | _Acesso interno (para mÃ©tricas do MySQL)_        |
| ğŸ“¦ **MongoDB Exporter**  | `9216`  | _Acesso interno (para mÃ©tricas do MongoDB)_      |
| ğŸ“¦ **Redis Exporter**    | `9121`  | _Acesso interno (para mÃ©tricas do Redis)_        |
| ğŸ˜ **Postgres Exporter** | `9187`  | _Acesso interno (para mÃ©tricas do PostgreSQL)_   |
| ğŸ° **RabbitMQ Exporter** | `9419`  | _Acesso interno (para mÃ©tricas do RabbitMQ)_     |
| ğŸ”‘ **Keycloak**          | `8084`  | [http://localhost:8084](http://localhost:8084)   |

> ğŸ’¡**Obs:** Consulte o `docker-compose.yml` para detalhes completos de configuraÃ§Ã£o e variÃ¡veis de ambiente de cada serviÃ§o.

## ğŸ§° Scripts e UtilitÃ¡rios

Este projeto oferece comandos prÃ¡ticos para gerenciar a infraestrutura e os serviÃ§os. VocÃª pode executÃ¡-los utilizando o `Makefile` ou os scripts definidos no `package.json` com `npm run`. Escolha a abordagem que preferir.

### convert_junit_to_sonar.py

## ğŸ”„ ImportÃ¢ncia do Script `convert_junit_to_sonar.py`

O script `convert_junit_to_sonar.py` desempenha um papel fundamental na integraÃ§Ã£o entre os testes automatizados do projeto e a anÃ¡lise de qualidade de cÃ³digo realizada pelo SonarQube.

### Por que ele Ã© importante?

- **PadronizaÃ§Ã£o de RelatÃ³rios:** Testes executados com frameworks como Pytest ou outros geram relatÃ³rios no formato JUnit XML, que nem sempre sÃ£o totalmente compatÃ­veis com o formato esperado pelo SonarQube.
- **IntegraÃ§Ã£o com SonarQube:** O script converte automaticamente o relatÃ³rio de testes do padrÃ£o JUnit para o formato aceito pelo SonarQube, permitindo que os resultados dos testes sejam corretamente interpretados e exibidos nos dashboards de qualidade.
- **AutomaÃ§Ã£o no Pipeline:** Essa conversÃ£o Ã© feita de forma automatizada durante o processo de CI/CD, garantindo que a cobertura de testes e os resultados estejam sempre atualizados e integrados Ã  anÃ¡lise estÃ¡tica de cÃ³digo.
- **Visibilidade e Qualidade:** Com os relatÃ³rios convertidos, Ã© possÃ­vel visualizar facilmente quais testes passaram, falharam ou foram ignorados diretamente na interface do SonarQube, aumentando a transparÃªncia e facilitando a identificaÃ§Ã£o de pontos de melhoria no cÃ³digo.

### Como utilizar

O script Ã© chamado automaticamente pelo Makefile e pelos scripts npm apÃ³s a execuÃ§Ã£o dos testes, nÃ£o sendo necessÃ¡rio rodÃ¡-lo manualmente na maioria dos casos. Caso precise executar manualmente, utilize:

```bash
python3 [convert_junit_to_sonar.py](http://_vscodecontentref_/0) <input_junit.xml> <output_sonar.xml>
```

> ğŸ’¡Resumo:
> O convert_junit_to_sonar.py garante que a qualidade dos testes do projeto seja refletida de forma precisa e integrada no SonarQube, fortalecendo o ciclo de feedback e a confiabilidade do seu pipeline de desenvolvimento.

### ğŸ”¹ Inicializar e Gerenciar Containers

| Comando        | DescriÃ§Ã£o                                                    | Comando Alternativo (npm) |
| -------------- | ------------------------------------------------------------ | ------------------------- |
| `make up`      | Inicia todos os containers definidos na variÃ¡vel `SERVICES`. | `npm run start`           |
| `make down`    | Para todos os containers, mantendo os volumes.               | `npm run stop`            |
| `make rebuild` | Para, faz build e reinicia todos os containers definidos.    | `npm run rebuild`         |

### ğŸ”¹ Logs e Status

| Comando     | DescriÃ§Ã£o                                         | Comando Alternativo (npm) |
| ----------- | ------------------------------------------------- | ------------------------- |
| `make logs` | Exibe os logs em tempo real de todos os serviÃ§os. | `npm run logs`            |
| `make ps`   | Lista os containers ativos.                       | NÃ£o disponÃ­vel via npm    |

### ğŸ”¹ Build e Rebuild

| Comando        | DescriÃ§Ã£o                                      | Comando Alternativo (npm) |
| -------------- | ---------------------------------------------- | ------------------------- |
| `make build`   | Faz o build dos containers.                    | `npm run build`           |
| `make rebuild` | ReconstrÃ³i os containers forÃ§ando a recriaÃ§Ã£o. | `npm run rebuild`         |

### ğŸ”¹ VerificaÃ§Ã£o de DependÃªncias

| Comando                               | DescriÃ§Ã£o                                                  | Comando Alternativo (npm) |
| ------------------------------------- | ---------------------------------------------------------- | ------------------------- |
| `make check-deps`                     | Executa o OWASP Dependency-Check com configuraÃ§Ãµes padrÃ£o. | `npm run check-deps`      |
| `make check-deps-path path=<caminho>` | Executa o Dependency-Check em um caminho especÃ­fico.       | `npm run check-deps-path` |

### ğŸ”¹ Lint e FormataÃ§Ã£o (npm apenas)

| Comando          | DescriÃ§Ã£o                                                  |
| ---------------- | ---------------------------------------------------------- |
| `npm run lint`   | Executa o ESLint para verificar problemas no cÃ³digo.       |
| `npm run format` | Executa o Prettier para formatar o cÃ³digo automaticamente. |

> ğŸ’¡ **Nota:** Certifique-se de configurar corretamente o arquivo `.env` antes de executar os comandos acima.

### Como escolher entre `make` e `npm run`?

- Use `make` se vocÃª jÃ¡ estÃ¡ familiarizado com o Makefile e prefere gerenciar os serviÃ§os diretamente.
- Use `npm run` se vocÃª prefere centralizar os comandos no `package.json` e utilizar o mesmo fluxo de trabalho para desenvolvimento e automaÃ§Ã£o.

Ambas as abordagens sÃ£o equivalentes e oferecem flexibilidade para atender Ã s suas preferÃªncias.

## ğŸŒ Prometheus Configuration

Este projeto utiliza **Prometheus** para monitoramento e coleta de mÃ©tricas. A configuraÃ§Ã£o define os intervalos de coleta e os serviÃ§os que serÃ£o monitorados.

### ğŸ”„ ConfiguraÃ§Ã£o Global

| ConfiguraÃ§Ã£o               | DescriÃ§Ã£o                                            |
| -------------------------- | ---------------------------------------------------- |
| `scrape_interval: 15s`     | Intervalo de coleta de mÃ©tricas (a cada 15 segundos) |
| `evaluation_interval: 15s` | Intervalo para avaliaÃ§Ã£o de regras                   |

### ğŸ“¡ ServiÃ§os Configurados para Scrape pelo Prometheus

Este documento lista os serviÃ§os que estÃ£o configurados para serem monitorados via Prometheus, conforme definido no arquivo `prometheus.yml`.

| **Job Name**                  | **Porta** | **DescriÃ§Ã£o**                                                              |
| ----------------------------- | --------- | -------------------------------------------------------------------------- |
| `prometheus`                  | `9090`    | Monitoramento do prÃ³prio Prometheus (mÃ©tricas internas)                    |
| `node-exporter`               | `9100`    | Coleta mÃ©tricas do sistema operacional (CPU, memÃ³ria, disco etc.)          |
| `cadvisor`                    | `8080`    | Monitoramento dos containers Docker e uso de recursos                      |
| `mongodb-exporter`            | `9216`    | Exporta mÃ©tricas das instÃ¢ncias do MongoDB                                 |
| `postgres-exporter`           | `9187`    | Exporta mÃ©tricas dos bancos de dados PostgreSQL                            |
| `mysql-exporter`              | `9104`    | Exporta mÃ©tricas dos bancos de dados MySQL                                 |
| `redis-exporter`              | `9121`    | Exporta mÃ©tricas das instÃ¢ncias Redis                                      |
| `rabbitmq-exporter`           | `9419`    | Exporta mÃ©tricas da fila de mensageria RabbitMQ                            |
| `blackbox-exporter`           | `9115`    | Realiza sondagens HTTP e monitoramento de disponibilidade/latÃªncia externa |
| `crud-users-api`              | `8089`    | ExpÃµe mÃ©tricas personalizadas via Spring Boot Actuator                     |
| `blackbox-exporter-icmp-ping` | `9115`    | Realiza ping ICMP para monitoramento de hosts externos (ex: DNS do Google) |

## âš™ï¸ Exemplo de ConfiguraÃ§Ã£o

Aqui estÃ¡ um exemplo do trecho YAML utilizado para definir os alvos de monitoramento:

```yaml
# ğŸ“Š Monitor Prometheus itself
- job_name: 'prometheus'
  static_configs:
    - targets: ['prometheus:9090'] # ğŸ  Local Prometheus server

# ğŸ–¥ï¸ Monitor host system resources (CPU, RAM, Disk)
- job_name: 'node-exporter'
  static_configs:
    - targets: ['node-exporter:9100'] # ğŸ”Œ Default Node Exporter port

# ğŸ³ Monitor running Docker containers
- job_name: 'cadvisor'
  static_configs:
    - targets: ['cadvisor:8080'] # ğŸ“¦ cAdvisor metrics endpoint

# ğŸƒ MongoDB exporter
- job_name: 'mongodb-exporter'
  static_configs:
    - targets: ['mongodb-exporter:9216'] # ğŸ“Š MongoDB metrics

# ğŸ˜ PostgreSQL exporter
- job_name: 'postgres-exporter'
  static_configs:
    - targets: ['postgres-exporter:9187'] # ğŸ“Š PostgreSQL metrics

# ğŸ¬ MySQL exporter
- job_name: 'mysql-exporter'
  static_configs:
    - targets: ['mysql-exporter:9104'] # ğŸ“Š MySQL metrics

# ğŸ§  Redis exporter
- job_name: 'redis-exporter'
  static_configs:
    - targets: ['redis-exporter:9121'] # ğŸ“Š Redis metrics

# ğŸ° RabbitMQ exporter
- job_name: 'rabbitmq-exporter'
  static_configs:
    - targets: ['rabbitmq-exporter:9419'] # ğŸ“Š RabbitMQ metrics

# ğŸŒ Blackbox Exporter (HTTP probe)
- job_name: 'blackbox-exporter'
  static_configs:
    - targets: ['blackbox-exporter:9115'] # ğŸ›°ï¸ Blackbox exporter metrics endpoint

# âš™ï¸ Spring Boot API metrics via Actuator
- job_name: 'crud-users-api'
  metrics_path: /actuator/prometheus
  params:
    module: [http_2xx, http_3xx, http_4xx, http_5xx]
  static_configs:
    - targets: ['crud-users-api:8089'] # ğŸ§ª Application metrics

# ğŸŒ Blackbox Exporter for ICMP Ping
- job_name: 'blackbox-exporter-icmp-ping'
  metrics_path: /probe
  params:
    module: [icmp_ping]
  static_configs:
    - targets:
        - 8.8.8.8 # ğŸ“¡ Google DNS or target IP to monitor
  relabel_configs:
    - source_labels: [__address__]
      target_label: __param_target
    - source_labels: [__param_target]
      target_label: instance
    - target_label: __address__
      replacement: blackbox-exporter:9115
```

> ğŸ’¡ **Nota:** Certifique-se de que os serviÃ§os listados estÃ£o rodando corretamente e acessÃ­veis pelas portas configuradas para uma coleta eficiente de mÃ©tricas.

## ğŸš¨ ImportÃ¢ncia do arquivo `alerts.yml`

O arquivo `alerts.yml` Ã© fundamental para a configuraÃ§Ã£o de alertas no ecossistema de monitoramento do projeto, especialmente quando integrado ao Prometheus e ao Alertmanager.

### Por que ele Ã© importante?

- **CentralizaÃ§Ã£o das Regras de Alerta:** O `alerts.yml` define todas as regras que determinam quando um alerta deve ser disparado com base nas mÃ©tricas coletadas pelo Prometheus.
- **Monitoramento Proativo:** Permite identificar automaticamente situaÃ§Ãµes anÃ´malas, falhas de serviÃ§o, uso excessivo de recursos ou indisponibilidade de aplicaÃ§Ãµes, facilitando a resposta rÃ¡pida a incidentes.
- **IntegraÃ§Ã£o com Alertmanager:** Os alertas definidos neste arquivo sÃ£o processados pelo Alertmanager, que pode encaminhÃ¡-los para e-mails, chats, sistemas de incidentes ou outras ferramentas de notificaÃ§Ã£o.
- **PersonalizaÃ§Ã£o:** As regras podem ser adaptadas conforme as necessidades do projeto, permitindo monitorar desde bancos de dados e filas atÃ© APIs e infraestrutura.

### Como funciona no projeto

- O arquivo `alerts.yml` Ã© referenciado na configuraÃ§Ã£o do Prometheus (`prometheus.yml`), garantindo que todas as regras de alerta estejam ativas durante a execuÃ§Ã£o da stack.
- Ao detectar uma condiÃ§Ã£o definida (por exemplo, serviÃ§o fora do ar, uso de CPU elevado, falha em banco de dados), o Prometheus dispara um alerta conforme especificado no `alerts.yml`.
- O Alertmanager recebe o alerta e executa as aÃ§Ãµes de notificaÃ§Ã£o configuradas.

### Exemplo de uso

```yaml
groups:
  - name: example-alerts
    rules:
      - alert: InstanceDown
        expr: up == 0
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: 'Instance {{ $labels.instance }} is down'
          description: 'The service {{ $labels.job }} on {{ $labels.instance }} has not responded for over 1 minute.'
```

> ğŸ’¡ Resumo:
> O alerts.yml torna o monitoramento do projeto proativo e inteligente, permitindo que a equipe seja notificada rapidamente sobre problemas crÃ­ticos, aumentando a confiabilidade e a disponibilidade da infraestrutura.

## ğŸ” Vault - Gerenciamento Seguro de Segredos

O **Vault** Ã© utilizado para armazenar e gerenciar segredos, tokens, certificados e outras informaÃ§Ãµes sensÃ­veis de forma centralizada e segura. Ele Ã© fundamental para proteger credenciais e variÃ¡veis de ambiente em ambientes de desenvolvimento e produÃ§Ã£o.

### ğŸ“¦ DescriÃ§Ã£o do ServiÃ§o

- **Imagem:** Utiliza a imagem oficial do HashiCorp Vault.
- **PersistÃªncia:** Os dados do Vault sÃ£o armazenados em um volume dedicado para garantir que segredos nÃ£o sejam perdidos apÃ³s reinicializaÃ§Ãµes.
- **Rede:** Integrado Ã  rede compartilhada da infraestrutura para comunicaÃ§Ã£o segura com outros serviÃ§os.
- **Porta:** O serviÃ§o Ã© exposto na porta 8200 do host para acesso Ã  interface HTTP/API do Vault.

### âš™ï¸ InstalaÃ§Ã£o e ConfiguraÃ§Ã£o

O Vault jÃ¡ estÃ¡ configurado no `docker-compose.yml`. Para subir o serviÃ§o:

```bash
make up-service service=vault
# ou
docker compose --env-file .env up -d vault
```

### ConfiguraÃ§Ã£o Inicial

1. Acesse a interface do Vault:

> URL: http://localhost:8200

2. Inicialize o Vault (primeira execuÃ§Ã£o):

- No terminal do container:

```
docker exec -it infra-default-vault vault operator init
```

- Guarde as chaves de unseal e o token root gerados.

3. Desbloqueie o Vault (Unseal):

Ainda no terminal do container, execute:

```
docker exec -it infra-default-vault vault operator unseal <unseal_key>
```

- Repita o comando com pelo menos 3 chaves de unseal diferentes.

4. Acesse com o token root:

- Use o token root gerado na inicializaÃ§Ã£o para acessar a interface web ou a CLI.

### VariÃ¡veis de Ambiente

No arquivo .env, configure as variÃ¡veis necessÃ¡rias para o Vault, por exemplo:

```
VAULT_DEV_ROOT_TOKEN_ID=changeme
VAULT_LOCAL_CONFIG={"backend": {"file": {"path": "/vault/file"}}, "listener": [{"tcp": {"address": "0.0.0.0:8200", "tls_disable": 1}}], "ui": true}
```

### PersistÃªncia de Dados

Os dados do Vault sÃ£o persistidos no volume:

```
volumes:
  infra-default-vault_data:
```

### ReferÃªncia:

DocumentaÃ§Ã£o Oficial do Vault
https://www.vaultproject.io/docs

> ğŸ’¡ Dica:
> Para ambientes de produÃ§Ã£o, configure o Vault com TLS habilitado e backend de storage seguro (Consul, S3, etc).

## ğŸ” OWASP Dependency-Check

Este projeto inclui um **script de verificaÃ§Ã£o de dependÃªncias** utilizando [OWASP Dependency-Check](https://owasp.org/www-project-dependency-check/), que identifica vulnerabilidades em bibliotecas e pacotes do projeto.

## âš™ï¸ ConfiguraÃ§Ã£o

O script analisa o diretÃ³rio do projeto e gera relatÃ³rios detalhados sobre possÃ­veis vulnerabilidades.

### ğŸ“‚ Estrutura de DiretÃ³rios

- **PROJECT_PATH**: Caminho do projeto analisado (padrÃ£o: diretÃ³rio atual).
- **REPORT_PATH**: Caminho onde os relatÃ³rios de anÃ¡lise serÃ£o armazenados.

## ğŸ” **Verificar dependÃªncias de seguranÃ§a**

Utilize o OWASP Dependency Check para verificar vulnerabilidades nas dependÃªncias do projeto:

### ğŸš€ Como Executar

Para rodar a verificaÃ§Ã£o de dependÃªncias, execute o seguintes comandos no terminal:

```bash
make check-deps
```

Para verificar um caminho especÃ­fico:

```bash
make check-deps-path path=/seu/caminho
```

Os relatÃ³rios serÃ£o gerados na pasta `reports/`:

ğŸ“ **RelatÃ³rio HTML:** `reports/index.html`

## ğŸ”® **Passos futuros**

- [x] ğŸ“¦ Adicionar suporte ao Redis e RabbitMQ.
- [ ] ğŸ”’ Implementar autenticaÃ§Ã£o para os serviÃ§os expostos.
- [x] ğŸ§ª Criar testes automatizados para validar a infraestrutura.
- [x] **ğŸ› ï¸ Refatorar build scripts para utilizar `npm`:**
  - [x] âš™ï¸ Analisar os comandos atuais do `Makefile` e identificar os equivalentes em scripts `npm`.
  - [x] ğŸ“ Criar scripts no `package.json` (por exemplo, `build`, `start`, `test`, `lint`).
  - [x] ğŸ”„ Substituir as chamadas ao `make` por comandos `npm run <script>`.
  - [x] ğŸ“„ Documentar a nova estrutura de build com `npm`.
- [ ] **âœ¨ Otimizar o fluxo de desenvolvimento com `npm`:**
  - [x] â• Adicionar ferramentas de desenvolvimento como linters (`eslint`, `prettier`) e formatadores como dependÃªncias de desenvolvimento (`devDependencies`).
  - [x] âš™ï¸ Configurar scripts `npm` para executar essas ferramentas (por exemplo, `lint`, `format`).
  - [ ] ğŸ£ Integrar essas verificaÃ§Ãµes no ciclo de desenvolvimento (por exemplo, atravÃ©s de hooks de commit com `husky`).
- [ ] **âš™ï¸ Considerar ferramentas de automaÃ§Ã£o de tarefas para DevInfra (Makefile, Task, Shell Scripts)**
  - [x] ğŸ§© Automatizar tarefas comuns com `Makefile` e scripts shell
  - [ ] ğŸ” Integrar hardening de containers com `Docker Bench` ou `Dockle`
  - [x] ğŸ§ª Adicionar testes automatizados dos serviÃ§os usando `bats` ou `Testcontainers`
  - [x] ğŸ§± Modularizar serviÃ§os com uso de redes nomeadas e volumes persistentes
  - [ ] ğŸ“Š Configurar dashboards personalizados de monitoramento visual com Grafana e alertas no Prometheus

> ğŸ’¡ **Nota:** Este projeto estÃ¡ em constante desenvolvimento. Algumas funcionalidades podem estar incompletas ou sujeitas a alteraÃ§Ãµes. ContribuiÃ§Ãµes sÃ£o sempre bem-vindas! ğŸ› ï¸

## ğŸŒ **Junte-se a nÃ³s**

Se vocÃª acredita que este projeto pode ajudar outros desenvolvedores, compartilhe com sua rede! Vamos construir juntos uma infraestrutura de desenvolvimento mais eficiente e acessÃ­vel para todos. ğŸš€âœ¨

## ğŸ› ï¸ **Contribua e faÃ§a parte da comunidade**

Este projeto Ã© **open-source** e estÃ¡ em constante evoluÃ§Ã£o. Sua contribuiÃ§Ã£o Ã© muito bem-vinda! Seja vocÃª um desenvolvedor experiente ou iniciante, hÃ¡ vÃ¡rias formas de ajudar:

- ğŸ’¬ **Sugira melhorias:** Abra uma issue com suas ideias.
- ğŸ› ï¸ **Contribua com cÃ³digo:** Envie pull requests com novas funcionalidades ou correÃ§Ãµes.
- â­ **DÃª uma estrela no GitHub:** Isso ajuda o projeto a alcanÃ§ar mais desenvolvedores.

## ğŸ™ **Agradecimentos**

Agradecemos por utilizar este projeto! Caso tenha sugestÃµes, melhorias ou encontre algum problema, sinta-se Ã  vontade para abrir uma issue ou enviar um pull request. Sua contribuiÃ§Ã£o Ã© muito bem-vinda! ğŸ’¡

## âœï¸ **Autor**

Desenvolvido por **Kleilson Santos**.

## ğŸ“¬ Contato

- ğŸ“§ Email: kleilson@icloud.com
- ğŸ”— LinkedIn: [linkedin.com/in/kleilson-dev-full-stack](https://linkedin.com/in/kleilson-dev-full-stack)
- ğŸ’» GitHub: [Kleilson Santos](https://github.com/KleilsonSantos)

<p align="center"><b>âš¡ Construa com seguranÃ§a, teste com propÃ³sito, automatize com clareza.<br>by Kleilson Santos ğŸš€</b></p>
